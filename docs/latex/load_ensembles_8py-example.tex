\hypertarget{load_ensembles_8py-example}{}\section{load\+\_\+ensembles.\+py}

\begin{DoxyCodeInclude}{0}
\end{DoxyCodeInclude}
 Example of how to load and plot results from multiple ensembles useful in generating histograms from mutiple Monte Carlo tests (ensembles). Additionally, simulation diagnostics are also loaded and plotted. See the S\+E\+T\+UP section


\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{1 }
\DoxyCodeLine{2 }
\DoxyCodeLine{7 }
\DoxyCodeLine{8 }
\DoxyCodeLine{9 \textcolor{keyword}{import} os.path}
\DoxyCodeLine{10 \textcolor{keyword}{import} sys}
\DoxyCodeLine{11 sys.path.append(os.path.join(os.path.dirname(\_\_file\_\_), \textcolor{stringliteral}{'..'}))}
\DoxyCodeLine{12 }
\DoxyCodeLine{13 \textcolor{keyword}{import} os}
\DoxyCodeLine{14 \textcolor{keyword}{import} pandas \textcolor{keyword}{as} pd}
\DoxyCodeLine{15 \textcolor{keyword}{import} numpy \textcolor{keyword}{as} np}
\DoxyCodeLine{16 \textcolor{keyword}{import} matplotlib.pyplot \textcolor{keyword}{as} plt}
\DoxyCodeLine{17 }
\DoxyCodeLine{18 \textcolor{keyword}{from} DOT\_assignment \textcolor{keyword}{import} post\_process}
\DoxyCodeLine{19 \textcolor{keyword}{from} DOT\_assignment \textcolor{keyword}{import} log}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{keywordflow}{if} \_\_name\_\_ == \textcolor{stringliteral}{"\_\_main\_\_"}:}
\DoxyCodeLine{22 }
\DoxyCodeLine{23 \textcolor{comment}{\# SETUP}}
\DoxyCodeLine{24 \textcolor{comment}{\# .\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{25 }
\DoxyCodeLine{26     \textcolor{comment}{\# loads all ensembles within a desired directory}}
\DoxyCodeLine{27     dim = 3}
\DoxyCodeLine{28 }
\DoxyCodeLine{29     \textcolor{comment}{\# get list of ensemble tests}}
\DoxyCodeLine{30     root\_directory = \textcolor{stringliteral}{'/Users/koray/Documents/GradSchool/research/gorodetsky/draper/devspace/targetingmdp/'}}
\DoxyCodeLine{31     \textcolor{comment}{\# elements = [x[0] for x in os.walk(ensemble\_directory)] \# recursively get (root, dirs, files)}}
\DoxyCodeLine{32     dirs = next(os.walk(root\_directory))[1]}
\DoxyCodeLine{33     ensembles = []}
\DoxyCodeLine{34     \textcolor{keywordflow}{for} d \textcolor{keywordflow}{in} dirs:}
\DoxyCodeLine{35         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'ensemble\_0'} \textcolor{keywordflow}{in} d:}
\DoxyCodeLine{36             ensembles.append(d)}
\DoxyCodeLine{37 }
\DoxyCodeLine{38     \textcolor{comment}{\# ensemble engagement scenarios that are loaded. loads 5v5, 10v10, 20v20 agent-target engagements}}
\DoxyCodeLine{39     desired\_conditions = [\textcolor{stringliteral}{'5v5'}, \textcolor{stringliteral}{'10v10'}, \textcolor{stringliteral}{'20v20'}]}
\DoxyCodeLine{40     \textcolor{comment}{\# desired\_conditions = ['5v5', '10v10']}}
\DoxyCodeLine{41 }
\DoxyCodeLine{42 \textcolor{comment}{\# .\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#\#}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44     ensembles\_to\_load = []}
\DoxyCodeLine{45     \textcolor{keywordflow}{for} ensemble \textcolor{keywordflow}{in} ensembles:}
\DoxyCodeLine{46         \textcolor{keywordflow}{for} condition \textcolor{keywordflow}{in} desired\_conditions:}
\DoxyCodeLine{47             \textcolor{keywordflow}{if} condition \textcolor{keywordflow}{in} ensemble:}
\DoxyCodeLine{48                 ensembles\_to\_load.append(ensemble)}
\DoxyCodeLine{49 }
\DoxyCodeLine{50     \textcolor{comment}{\# load ensembles and plot}}
\DoxyCodeLine{51     sim\_name\_list = [\textcolor{stringliteral}{'AssignmentDyn'}, \textcolor{stringliteral}{'AssignmentEMD'}]}
\DoxyCodeLine{52     loaded\_ensemble\_metrics = \{\}}
\DoxyCodeLine{53     loaded\_ensemble\_diagnostics = \{\}}
\DoxyCodeLine{54     \textcolor{keywordflow}{for} ensemble\_name \textcolor{keywordflow}{in} ensembles\_to\_load:}
\DoxyCodeLine{55 }
\DoxyCodeLine{56         ensemble\_directory = root\_directory + ensemble\_name}
\DoxyCodeLine{57 }
\DoxyCodeLine{58         \textcolor{comment}{\# get number of batches}}
\DoxyCodeLine{59         batch\_dirs = [x[0] \textcolor{keywordflow}{for} x \textcolor{keywordflow}{in} os.walk(ensemble\_directory)]}
\DoxyCodeLine{60         nbatches = len(batch\_dirs[1:])}
\DoxyCodeLine{61 }
\DoxyCodeLine{62         \textcolor{comment}{\# metrics}}
\DoxyCodeLine{63         ensemble\_metrics = []}
\DoxyCodeLine{64         \textcolor{keywordflow}{for} ii \textcolor{keywordflow}{in} range(nbatches):}
\DoxyCodeLine{65             batch\_name = \textcolor{stringliteral}{'batch\_\{0\}'}.format(ii)}
\DoxyCodeLine{66             loaded\_batch = log.load\_batch\_metrics(ensemble\_directory, batch\_name, sim\_name\_list)}
\DoxyCodeLine{67             ensemble\_metrics.append(loaded\_batch)}
\DoxyCodeLine{68         loaded\_ensemble\_metrics.update(\{ensemble\_name: ensemble\_metrics\})}
\DoxyCodeLine{69 }
\DoxyCodeLine{70         \textcolor{comment}{\# \# diagnostics}}
\DoxyCodeLine{71         \textcolor{comment}{\# ensemble\_diagnostics = []}}
\DoxyCodeLine{72         \textcolor{comment}{\# for ii in range(nbatches):}}
\DoxyCodeLine{73         \textcolor{comment}{\#     batch\_name = 'batch\_\{0\}'.format(ii)}}
\DoxyCodeLine{74         \textcolor{comment}{\#     loaded\_batch\_diagnostics = log.load\_batch\_diagnostics(ensemble\_directory, batch\_name, sim\_name\_list)}}
\DoxyCodeLine{75         \textcolor{comment}{\#     ensemble\_diagnostics.append(loaded\_batch\_diagnostics)}}
\DoxyCodeLine{76         \textcolor{comment}{\# loaded\_ensemble\_diagnostics.update(\{ensemble\_name: ensemble\_diagnostics\})}}
\DoxyCodeLine{77 }
\DoxyCodeLine{78     post\_process.plot\_ensemble\_metric\_comparisons(loaded\_ensemble\_metrics)}
\DoxyCodeLine{79     \textcolor{comment}{\# post\_process.plot\_ensemble\_diagnostic\_comparison(loaded\_ensemble\_diagnostics)}}
\DoxyCodeLine{80 }
\DoxyCodeLine{81     print(\textcolor{stringliteral}{'finished plotting!'})}
\DoxyCodeLine{82 }
\DoxyCodeLine{83     plt.show()}
\DoxyCodeLine{84     print(\textcolor{stringliteral}{'done!'})}
\DoxyCodeLine{85 }
\DoxyCodeLine{86 }
\end{DoxyCodeInclude}
 